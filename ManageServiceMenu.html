<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Bombshell Dashboard</title>
    <!-- Make it stylish now -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.2/css/materialize.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.css" rel="stylesheet">
    <link rel="stylesheet" href="css/BombshellDashboard.css">
    <!-- Adobe Type Kit -->
    <script src="https://use.typekit.net/mhf2njr.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>
  </head>
  <body>

  <!-- header begin -->

    <nav class="white" role="navigation">
    <div class="nav-wrapper container">
      <a id="logo-container" href="index.html" class="brand-logo" style="padding-top:15px" ><img style='height:100px' src="https://lh3.googleusercontent.com/rWQVLq9fpD-4ZQPyTBc39NGtfjHscscqSnaEtONmuysORm3frCZZJfNcJD1nHMZOtk9sEY3_vdLZG4xaJNs1_SFSUe68ztYMWHXqzZrSgrJHVRYuUGr8G5XoySr_usFAiqfhUst1_YJ0CA4xiL8BKYihqcQrruOyYl-TMWwprc71OQLfY5bbRI5HAJB_O7IbQULKkjVK9iooZsxAui-rSrry57K5gc27Rn2dPssMXq-5J8H1QEiLpIS4gkJNnuAwQWgcuTBdFHNYud1Nck5mRr5MryJNgqK5kPCaDLC4YBxPVuUaDs2ZAfmfZeb0-fT9XBvPY20T-PX9Q-Ox7kNy56pORWbX-oCHsKwsQOLDSaiZuOhcuwUWt5r4gTN9bwAMDw-y_TXqa9IqudsX1pYKZysKIJ6pLO9TGZ-ikFUjAsaPXhroM1HbkY9LF332UExaywO_GTDMgZXhlY_9tfGfhLe0_dkeUlS7GBbWqH56wePVqHBlAEWlM7Ra1Cq5AgFsKWYkHELCoDfvOc_BKOs56AqLm4anSVUyG4BTzpyrYXk=w297-h150-no"></a>
      <ul class="right hide-on-med-and-down ">
        <li><a class='bombshellpink' href="ServiceLocation.html"> Locations</a></li>
        <li><a class='bombshellpink' href="#"> Service Menu</a></li>
        <li><a class='bombshellpink' href="#"> Specials</a></li>
        <li><a class='bombshellpink' href="#"> Logout</a></li>
      </ul>

      <ul id="nav-mobile" class="side-nav">
      <li><a class='bombshellpink' href="#"> Link</a></li>
      <li><a class='bombshellpink' href="#"> Link</a></li>
      <li><a class='bombshellpink' href="#"> Link</a></li>
      </ul>
      <a href="#" data-activates="nav-mobile" class="button-collapse "><i class="material-icons pink-text">menu</i></a>
    </div>
  </nav>
  <!-- end header --->

  <div class="row">
    <Br>
      <Br>
    <h1 id="BombshellLocation" class="bombshellHeading center-align" style="margin-bottom:0px"></h1>


    <div class="col l6 s12 offset-l3 left-align">

      <Br><Br>
        <div class="row">
          <a href="#" id="btnAddWaxingService" data-service='Waxing' class="addService btn-floating waves-effect waves-light black right  lighten-1 "><i class="material-icons">add</i></a><h3 class="bombshellHeading" style="font-size:28px">WAXING</h3>
          <ul id="waxingUL" class="collection with-header serviceLists"></ul>
        </div>

        <div class="row">
            <a href="#" id="btnAddSugaringService" data-service='Sugaring' class=" addService btn-floating waves-effect waves-light black right  lighten-1 "><i class="material-icons">add</i></a><h3 class="bombshellHeading" style="font-size:28px">SUGARING</h3>
          <ul id="SugaringUL" class="collection with-header serviceLists"></ul>
        </div>


        <div class="row">
            <a href="#" id="btnAddTanningService" data-service='Tanning' class="addService btn-floating waves-effect waves-light black right  lighten-1 "><i class="material-icons">add</i></a><h3 class="bombshellHeading" style="font-size:28px">TANNING</h3>
          <ul id="TanningUL" class="collection with-header serviceLists"></ul>
        </div>

        <div class="row">
            <a href="#" id="bntAddHairService" data-service='Hair' class=" addService btn-floating waves-effect waves-light black right  lighten-1 "><i class="material-icons">add</i></a><h3 class="bombshellHeading" style="font-size:28px">HAIR</h3>
          <ul id="HairUL" class="collection with-header serviceLists"></ul>
        </div>

        <div class="row">
            <a href="#" id="btnAddNailService" data-service='Nails' class=" addService btn-floating waves-effect waves-light black right  lighten-1 "><i class="material-icons">add</i></a><h3 class="bombshellHeading" style="font-size:28px">NAILS</h3>
          <ul id="NailUL" class="collection with-header serviceLists"></ul>
        </div>

        <div class="row">
            <a href="#" id="btnAddSkinCareService" data-service='Skin Care' class="addService btn-floating waves-effect waves-light black right  lighten-1 "><i class="material-icons">add</i></a><h3 class="bombshellHeading" style="font-size:28px">SKIN CARE</h3>
          <ul id="SkinCareUL" class="collection with-header serviceLists"></ul>
        </div>

        <div class="row">
            <a href="#" id="btnAddLaserHairRemoval" data-service='Laser Hair Removal' class="addService btn-floating waves-effect waves-light black right  lighten-1 "><i class="material-icons">add</i></a><h3 class="bombshellHeading" style="font-size:28px">LASER HAIR REMOVAL</h3>
          <ul id="LaserHairUL" class="collection with-header serviceLists"></ul>
        </div>

    </div>
  </div>



<!-- Modal Structure -->
<div id="ServiceAddWindow" class="modal">
  <div class="modal-content">


    <div class="row">
      <div class="col s12 left-align">

        <div class="input-field col s12">
          <h4 id="AddServiceName"></h4>
          <select id="dlServiceName" class="browser-default">
          </select>
          </div>
          <div class="input-field col s12 ">

              <input id="txtAddServicePrice" type="text">
              <label for="txtAddServicePrice">Service Price</label>
          </div>
      </div>
    </div>

  </div>
  <div class="modal-footer">
      <a id="btnAddServicetoLocation" href="#" class="btn white-text btn-flat right waves-effect pink">Save</a>
  </div>
</div>

<div id="ServiceEditPriceWindow" class="modal">
  <div class="modal-content">


    <div class="row">
      <div class="col s12 left-align">

        <div class="input-field col s12">
          <h4 id="EditServiceName"></h4>
          </div>
          <div class="input-field col s12 ">

              <input placeholder="100.00" id="txtEditServicePrice" type="text">
              <label for="txtEditServicePrice">Service Price</label>
          </div>
      </div>
    </div>

  </div>
  <div class="modal-footer">
      <a id="btnUpdateServicetoLocation" href="#" style="margin:10px;" class="btn white-text btn-flat right waves-effect pink">UPDATE</a>
      <a id="btnDeleteServicetoLocation" href="#" style="margin:10px;" class="btn white-text btn-flat right waves-effect grey">DELETE</a>

  </div>
</div>




  <!-- All da' JavaScriptzz -->
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="//www.parsecdn.com/js/parse-1.6.7.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.2/js/materialize.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert-dev.js"></script>
  <script src=https://cdnjs.cloudflare.com/ajax/libs/js-url/2.0.2/url.js></script>
  <script src="js/BombshellDashboard.js"></script>

  <script>

  $(document).ready(function(){
    //Load Locations
    Parse.initialize("6lwXuEam4Zl0heDrMSPQtRx2xcaLM792aRNjw1gF", "hvatZD2xQvA6mmL77SDQsc9T6kqrqLo8PbUmDswC");
    var theLocation = url('?location');
    $("#BombshellLocation").attr("data-location",theLocation);

    var Locationz = Parse.Object.extend("Locations");
    var locquery = new Parse.Query(Locationz);
    locquery.get( theLocation , {
  success: function(locationzzz) {
    // The object was retrieved successfully.
    $("#BombshellLocation").text(locationzzz.get('Name') + " Services");
  },
  error: function(object, error) {
    // The object was not retrieved successfully.
    // error is a Parse.Error with an error code and message.
  }
});


    //Load Each Service

    var ServicesOffered = Parse.Object.extend("ServicesOffered");
    var query = new Parse.Query(ServicesOffered);
    query.include('ServiceID');
    query.equalTo('Location',theLocation);
    query.find({
      success: function(results) {

        // Do something with the returned Parse.Object values
        for (var i = 0; i < results.length; i++) {
          var object = results[i];

          var ServiceType = object.get("ServiceID").get("ServiceType");
          var ServiceUL = '';

          switch(ServiceType) {
            case 'Waxing':
              ServiceUL = 'waxingUL';
              break;
            case 'Sugaring':
              ServiceUL = 'SugaringUL';
              break;
            case 'Tanning':
              ServiceUL = 'TanningUL';
              break;
            case 'Hair':
              ServiceUL = 'HairUL';
              break;
            case 'Nails':
              ServiceUL = 'NailUL';
              break;
            case 'Skin Care':
              ServiceUL = 'SkinCareUL';
              break;
            case 'Laser Hair Removal':
              ServiceUL = 'LaserHairUL';
              break;
            default:
              alert('whaaa???');
            }//end switch


            var listItem = "<li data-price='"+ object.get("Price") + "' data-servicename='"+ object.get("ServiceID").get("Service") +"' data-service='"+ object.id +"' class='collection-item'>"+  object.get("ServiceID").get("Service") +"<span class='right'>$"+ object.get('Price') +"</span></li>"
            $(listItem).appendTo("#"+ServiceUL);

        }
      },
      error: function(error) {
        alert("Error: " + error.code + " " + error.message);
      }
    });

    $(".serviceLists").delegate('.collection-item','click',function(){
      var whoami = $(this).attr('data-service');
      var serviceName = $(this).attr('data-servicename');
      var price = $(this).attr('data-price');
      $("#EditServiceName").text(serviceName);
      $("#txtEditServicePrice").val(price);
      $("#btnUpdateServicetoLocation").attr('data-who',whoami);
      $("#btnDeleteServicetoLocation").attr('data-who',whoami);
      $("#ServiceEditPriceWindow").openModal();
    })
    $(".serviceLists").delegate('.collection-item','mouseover',function(){
      $(this).css("cursor","pointer");
    })

    $("#btnDeleteServicetoLocation").click(function(){
      var me = $(this).attr('data-who');
      var Service = Parse.Object.extend("ServicesOffered");
      var service = new Service();
      service.id = me;
      service.destroy({
        success: function(service) {
          // The object was deleted from the Parse Cloud.
          swal({
            confirmButtonColor: "#009688",
            title: "Service Removed!",
            text: "Service successfully removed from this location.",
            type: "success",
            showCancelButton:false,
            confirmButtonColor:"#e91e63",
            confirmButtonText:"Cool",
            closeOnConfirm: false
          },
          function(){
            window.location.reload();
          });
        },
        error: function(service, error) {
          // The delete failed.
          // error is a Parse.Error with an error code and message.
          swal("Uh oh!", error.message, "error")
        }
      });
    }) // end btn delete click function



    $("#btnUpdateServicetoLocation").click(function(){
      var me = $(this).attr('data-who');
      var Service = Parse.Object.extend("ServicesOffered");
      var service = new Service();
      service.id = me;
      service.set("Price",$("#txtEditServicePrice").val());
      service.save(null, {
        success: function(service) {
          swal({
            confirmButtonColor: "#009688",
            title: "Service Updated!",
            text: "Service successfully updated for this location.",
            type: "success",
            showCancelButton:false,
            confirmButtonColor:"#e91e63",
            confirmButtonText:"Cool",
            closeOnConfirm: false
          },
          function(){
            window.location.reload();
          });
        }
      });
    }) // end btn update


  }) //end document ready function

  </script>

  </body>
</html>
